<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>DataProcessing - Excel 转 CSV</title>
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <main class="shell">
      <header class="hero">
        <p class="eyebrow">DataProcessing</p>
        <h1>股权风险溢价（ERP）处理器</h1>
        <p class="subhead">
          程序会自动读取 <span class="path">input</span> 中的
          <span class="path">data_PE.xlsx</span>、<span class="path">data_bond.xlsx</span>，
          并导出到 <span class="path">docs/data</span>。
        </p>
      </header>

      <section class="panel">
        <div class="actions">
          <button id="erp" type="button" class="ghost">生成 ERP（Feature 2）</button>
          <button id="erp10y" type="button" class="ghost">生成 ERP_10Year（Feature 3）</button>
          <button id="rolling" type="button" class="primary">生成 ERP_Rolling Calculation（Feature 4）</button>
          <button id="interval" type="button" class="ghost">生成 ERP_Interval（Feature 5）</button>
          <span id="status" class="status" aria-live="polite"></span>
        </div>

        <div class="control">
          <label for="rolling-n">滚动周期 n（交易日）</label>
          <div class="select-wrap">
            <input id="rolling-n" type="number" inputmode="numeric" min="1" max="4000" step="1" value="2000" />
          </div>
        </div>

        <div class="control">
          <label for="interval-start">固定区间起始日期（YYYY-MM-DD）</label>
          <div class="select-wrap">
            <input id="interval-start" type="date" />
          </div>
        </div>

        <div class="control">
          <label for="interval-end">固定区间终止日期（YYYY-MM-DD）</label>
          <div class="select-wrap">
            <input id="interval-end" type="date" />
          </div>
        </div>

        <div class="hint">
          <p class="hint-title">说明</p>
          <p class="hint-body">Feature 3 固定使用 n=2000（约 10 年）；Feature 4 支持自定义 n（范围 1-4000）。</p>
          <p class="hint-body">Feature 5 计算“起始日期→最近交易日”的区间统计，并输出水平布林线。</p>
          <p class="hint-body">输出：<span class="path">ERP.csv</span>、<span class="path">ERP_10Year.csv</span>、<span class="path">ERP_Rolling Calculation.csv</span>、<span class="path">ERP_Interval.csv</span>（同时生成同名 Excel）。</p>
        </div>
      </section>
    </main>

    <div id="modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="modal-title">
      <div class="modal-card">
        <h2 id="modal-title"></h2>
        <p id="modal-message"></p>
        <button id="modal-close" type="button" class="primary">知道了</button>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
